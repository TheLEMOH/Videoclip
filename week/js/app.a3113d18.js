(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],u=0,d=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,i=1;i<r.length;i++){var s=r[i];0!==a[s]&&(n=!1)}n&&(o.splice(e--,1),t=c(c.s=r[0]))}return t}var n={},i={app:0},a={app:0},o=[];function s(t){return c.p+"week/js/"+({}[t]||t)+"."+{"chunk-309e0c4e":"1f33dfd3"}[t]+".js"}function c(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(t){var e=[],r={"chunk-309e0c4e":1};i[t]?e.push(i[t]):0!==i[t]&&r[t]&&e.push(i[t]=new Promise((function(e,r){for(var n="week/css/"+({}[t]||t)+"."+{"chunk-309e0c4e":"6c5dbf74"}[t]+".css",a=c.p+n,o=document.getElementsByTagName("link"),s=0;s<o.length;s++){var l=o[s],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===n||u===a))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){l=d[s],u=l.getAttribute("data-href");if(u===n||u===a)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var n=e&&e.target&&e.target.src||a,o=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete i[t],p.parentNode.removeChild(p),r(o)},p.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(p)})).then((function(){i[t]=0})));var n=a[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,r){n=a[t]=[e,r]}));e.push(n[2]=o);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=s(t);var d=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var r=a[t];if(0!==r){if(r){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",d.name="ChunkLoadError",d.type=n,d.request=i,r[1](d)}a[t]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},c.m=t,c.c=n,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(r,n,function(e){return t[e]}.bind(null,n));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="./",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var p=u;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";r("85ec")},"33cf":function(t,e,r){"use strict";r("5ee4")},5490:function(t,e,r){"use strict";r("a6b6")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"body_videoclip"},[0!=t.layers.length?r("Map",{staticClass:"map_videoclip",attrs:{layers:t.layers,sites:t.receivedSites,projects:t.selectedProjects}}):t._e(),r("Control",{staticClass:"control_videoclip",attrs:{dates:t.dates,indicator:t.indicator,wind:t.receivedWind,tooltips:t.tooltips,loading:t.loading},on:{"update-time":t.UpdateMap,"update-indicator":t.UpdateIndicator,"show-analytic":t.ShowAnalytic,"update-projects":t.UpdateProjets}}),r("Analytics",{style:{visibility:1==t.showAnalytic?"visible":"hidden"},attrs:{data:t.selectedDataForChart,dataWind:t.selectedDataForChartWind,dataWindRose:t.selectedDataForRose,dataWindDir3hour:t.selectedDataForChartWindDir3hour,description:t.description}})],1)])},a=[],o=(r("d3b7"),r("3ca3"),r("ddb0"),r("d81d"),r("b680"),r("a9e3"),r("159b"),r("a4d3"),r("e01a"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mark_videoclip_container"},[n("div",{staticClass:"mark_videoclip_buttons m-2"},[n("div",{staticClass:"dropdown",staticStyle:{"z-index":"100"}},[n("button",{staticClass:"btn dropdown-toggle mark_videoclip_button text-left",attrs:{id:"dropdownMenuIndicators","data-toggle":"dropdown"}},[t._v(" "+t._s(t.indicator)+" "),n("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuIndicators"}},[n("h6",{staticClass:"m-1 font-weight-bold"},[t._v("Показатели")]),t._l(t.indicators,(function(e,r){return n("button",{key:r,staticClass:"dropdown-item",on:{click:function(r){return t.UpdateIndicator(e.type,e.description,e.name)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)])]),n("div",{staticClass:"dropdown"},[n("button",{staticClass:"btn dropdown-toggle mark_videoclip_button text-left",attrs:{id:"dropdownMenuProjects","data-toggle":"dropdown"}},[t._v(" Все источники ")]),n("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuProjects"}},[n("h6",{staticClass:"m-1 font-weight-bold"},[t._v("Источники данных")]),t._l(t.projects,(function(e,r){return n("div",{key:r,staticClass:"dropdown-item"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedProject,expression:"selectedProject"}],staticClass:"mr-2",attrs:{id:"videoclip_poject_"+e.id,type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(t.selectedProject)?t._i(t.selectedProject,e.id)>-1:t.selectedProject},on:{change:[function(r){var n=t.selectedProject,i=r.target,a=!!i.checked;if(Array.isArray(n)){var o=e.id,s=t._i(n,o);i.checked?s<0&&(t.selectedProject=n.concat([o])):s>-1&&(t.selectedProject=n.slice(0,s).concat(n.slice(s+1)))}else t.selectedProject=a},t.UpdateProject]}}),n("label",{staticStyle:{width:"100%"},attrs:{for:"videoclip_poject_"+e.id}},[t._v(t._s(e.name))])])}))],2)])]),n("div",{staticClass:"mark_videoclip_play"},[n("button",{staticClass:"btn-play",on:{click:t.Action}},[0==t.play?n("img",{staticClass:"img_videoclip",attrs:{src:r("5830")}}):n("img",{staticClass:"img_videoclip",attrs:{src:r("ec7e")}})])]),n("div",{staticClass:"mark_videoclip_tooltips"},[n("ul",{staticClass:"ul_videoclip w-100 p-0 m-0"},t._l(t.tooltips,(function(e,r){return n("li",{key:r,on:{click:function(e){return t.Active(r)}}},[n("div",{staticClass:"card mark_videoclip_tooltip",class:{mark_videoclip_tooltip_active:r==t.activeElement},style:{background:e.color,color:e.text}},[n("div",{staticClass:"\n              card-header\n              mark_videoclip_tooltip_header\n              p-0\n              m-0\n              text-center\n            ",style:{background:t.LightenDarkenColor(-.3,e.color),color:e.text}},[n("span",[t._v(t._s(t.Formater(t.dates[r])))])]),n("div",{staticClass:"card-body p-1 m-0"},[n("div",{staticClass:"info_videoclip_container"},[n("ul",{staticClass:"ul_info_videoclip text-center"},[n("li",[n("span",{staticClass:"mark_videoclip_text_PM"},[t._v(t._s(e.value))])])]),0!=t.wind.length?n("ul",{staticClass:"ul_info_videoclip_wind"},[n("li",[n("Sun",{staticClass:"icon_temp mr-1",attrs:{color:e.text}}),n("span",[t._v(t._s(t.wind.temp[r].max)+"°C")])],1),n("li",[n("Moon",{staticClass:"icon_temp mr-1",attrs:{color:e.text}}),n("span",[t._v(t._s(t.wind.temp[r].min)+"°C")])],1)]):t._e()])])])])})),0)]),n("div",{staticClass:"analytic_videoclip_button text-center"},[7==t.loading?n("img",{staticClass:"img_videoclip",attrs:{src:r("9618")},on:{click:t.ShowAnalytic}}):t._e(),7!=t.loading?n("img",{staticClass:"img_videoclip",attrs:{src:r("b889")}}):t._e()])])}),s=[],c=r("3835"),l=(r("7db0"),r("b0c0"),r("1276"),r("ac1f"),r("fb6a"),r("25f0"),r("2909")),u=r("1da1"),d=(r("96cf"),r("4de4"),r("13d5"),r("99af"),r("a79f"));d["a"].defs("EPSG:3857"),d["a"].defs("EPSG:4326"),d["a"].defs("EPSG:28416","+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +ellps=krass +towgs84=23.92,-141.27,-80.9,-0,0.35,0.82,-0.12 +units=m +no_defs");for(var p=[0,12,35.4,55.4,150,200,250,1e3],h=[0,50,100,150,200,300,500,1e3],m=[0,1,10],f=[0,2,4,7,100],g=[0,2,4,7,100],v={pm:p,aqi:h,mcp:m,speed:f,dir:g},b={pm:348,aqi:355,mcp:371,temp:103,dir:101,speed:102},y={pm:"PM",aqi:"AQI",mcp:"ПДК",temp:"Температура",dir:"Направление ветра",speed:"Скорость ветра"},x={pm:1e3,aqi:1,mcp:1,temp:1},w=["С","ССВ","СВ","ВСВ","В","ВЮВ","ЮВ","ЮЮВ","Ю","ЮЮЗ","ЮЗ","ЗЮЗ","З","ЗСЗ","СЗ","ССЗ"],_=[{color:"rgb(0,153,102)",text:"rgb(250,250,250)"},{color:"rgb(255,222,51)",text:"rgb(0,0,0)"},{color:"rgb(255,153,51)",text:"rgb(250,250,250)"},{color:"rgb(204,0,51)",text:"rgb(250,250,250)"},{color:"rgb(102,0,153)",text:"rgb(250,250,250)"},{color:"rgb(126,0,35)",text:"rgb(250,250,250)"},{color:"rgb(0,0,0)",text:"rgb(250,250,250)"}],j=[{color:"rgb(0,153,102)",text:"rgb(250,250,250)"},{color:"rgb(255,222,51)",text:"rgb(0,0,0)"},{color:"rgb(255,153,51)",text:"rgb(250,250,250)"},{color:"rgb(204,0,51)",text:"rgb(250,250,250)"},{color:"rgb(102,0,153)",text:"rgb(250,250,250)"},{color:"rgb(126,0,35)",text:"rgb(250,250,250)"},{color:"rgb(0,0,0)",text:"rgb(250,250,250)"}],k=[{color:"rgb(0,153,102)",text:"rgb(250,250,250)"},{color:"rgb(204,0,51)",text:"rgb(250,250,250)"}],C=[{color:"rgb(145, 238, 255)"},{color:"rgb(2, 188, 237)"},{color:"rgb(0, 136, 219)"},{color:"rgb(0, 82, 189)"},{color:"rgb(4, 13, 140)"}],P=[{color:"rgb(145, 238, 255)"},{color:"rgb(2, 188, 237)"},{color:"rgb(0, 136, 219)"},{color:"rgb(0, 82, 189)"},{color:"rgb(4, 13, 140)"}],E={pm:_,aqi:j,mcp:k,speed:C,dir:P},A=[],D=0;D<24;D+=3){var M=D<10?"0".concat(D,":00"):"".concat(D,":00");A.push(M)}function S(t,e,r,n){return F.apply(this,arguments)}function F(){return F=Object(u["a"])(regeneratorRuntime.mark((function t(e,r,n,i){var a,o,s,c,u,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.map((function(t){return b[t]})),o=r.map((function(t){return"https://gis.krasn.ru/sc/api/1.0/projects/".concat(t,"/aggvalues?&key=aa0orjtt0npfwyym&time_begin=").concat(e[0]," 00:00:00&time_end=").concat(e[e.length-1]," 23:00:00&time_interval=").concat(i,"&indicators=").concat(a,"&limit=30000'")})),s=o.map((function(t){return fetch(t)})),c=Promise.all(s),t.next=6,c.then((function(t){for(var e=[],n=0;n<t.length;n++)e.push(U(t[n],r[n]));return e}));case 6:u=t.sent,d=[],p=0;case 9:if(!(p<u.length)){t.next=21;break}return t.t0=d.push,t.t1=d,t.t2=l["a"],t.next=15,u[p];case 15:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 18:p++,t.next=9;break;case 21:return t.abrupt("return",d);case 22:case"end":return t.stop()}}),t)}))),F.apply(this,arguments)}function N(t,e,r){return I.apply(this,arguments)}function I(){return I=Object(u["a"])(regeneratorRuntime.mark((function t(e,r,n){var i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=r.map((function(t){return b[t]})),a="https://gis.krasn.ru/sc/api/1.0/projects/6/aggvalues?&key=aa0orjtt0npfwyym&sites=4203&time_begin=".concat(e[0]," 00:00:00&time_end=").concat(e[e.length-1]," 23:00:00&time_interval=").concat(n,"&indicators=").concat(i,"&limit=30000'"),o=fetch(a),s=o.then((function(t){return U(t)})),t.abrupt("return",s);case 5:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}function T(t,e){return O.apply(this,arguments)}function O(){return O=Object(u["a"])(regeneratorRuntime.mark((function t(e,r){var n,i,a,o,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=r.map((function(t){return"https://gis.krasn.ru/sc/api/1.0/projects/".concat(t,"/sites?&key=aa0orjtt0npfwyym&time_begin=").concat(e[0]," 00:00:00&time_end=").concat(e[e.length-1]," 00:00:00&limit=30000'")})),i=n.map((function(t){return fetch(t)})),a=Promise.all(i),t.next=5,a.then((function(t){for(var e=[],r=0;r<t.length;r++)e.push(R(t[r]));return e}));case 5:o=t.sent,s=[],c=0;case 8:if(!(c<o.length)){t.next=20;break}return t.t0=s.push,t.t1=s,t.t2=l["a"],t.next=14,o[c];case 14:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 17:c++,t.next=8;break;case 20:return t.abrupt("return",s);case 21:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function U(t,e){return L.apply(this,arguments)}function L(){return L=Object(u["a"])(regeneratorRuntime.mark((function t(e,r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.text().then((function(t){var e=[],n=new DOMParser,i=n.parseFromString(t,"text/xml"),a=i.getElementsByTagName("aggvalue");return a.forEach((function(t){var n=t.getAttribute("indicator"),i=t.getAttribute("time").substring(0,t.getAttribute("time").length-3).split(" ")[0],a=t.getAttribute("time").substring(0,t.getAttribute("time").length-3).split(" ")[1],o=Number(t.getElementsByTagName("avg")[0].innerHTML).toFixed(6),s=Number(t.getElementsByTagName("min")[0].innerHTML).toFixed(6),c=Number(t.getElementsByTagName("max")[0].innerHTML).toFixed(6),l=t.getAttribute("site"),u=t.getElementsByTagName("location")[0];if(u){var p=u.getAttribute("x"),h=u.getAttribute("y");e.push({site:l,project:r,indicator:n,time:i,hour:a,value:o,min:s,max:c,coordinates:Object(d["a"])("EPSG:4326","EPSG:28416",[Number(p),Number(h)])})}})),e})),t.abrupt("return",n);case 2:case"end":return t.stop()}}),t)}))),L.apply(this,arguments)}function R(t){return G.apply(this,arguments)}function G(){return G=Object(u["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.text().then((function(t){var e=[],r=new DOMParser,n=r.parseFromString(t,"text/xml"),i=n.getElementsByTagName("site");return i.forEach((function(t){var r=t.getAttribute("id"),n=t.getElementsByTagName("location")[0],i=t.getElementsByTagName("name")[0].innerHTML;n&&e.push({id:r,name:i})})),e})),t.abrupt("return",r);case 2:case"end":return t.stop()}}),t)}))),G.apply(this,arguments)}function B(){return z.apply(this,arguments)}function z(){return z=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=new Date,r=new Date,n=[],r.setDate(r.getDate()-7);while(r.getTime()<e.getTime())n.push(W(r)),r.setDate(r.getDate()+1);return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),z.apply(this,arguments)}function W(t){var e=t.getDate();e<10&&(e="0"+e);var r=t.getMonth()+1;r<10&&(r="0"+r);var n=t.getFullYear();return n<10&&(n="0"+n),n+"-"+r+"-"+e}function q(t,e){if(e){var r=t.split(" ")[0].split("-"),n=new Date(r[0],r[1]-1,r[2],0,0,0).toLocaleString("ru",{month:"short",day:"numeric"});return n}if(void 0!=t){var i=t.split(" ")[0].split("-"),a=new Date(i[0],i[1]-1,i[2],0,0,0).toLocaleString("ru",{month:"short",day:"numeric",weekday:"short"});return a}return(new Date).toLocaleString("ru",{month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric"})}function $(t,e,r){var n=b[r],i=t.filter((function(t){if(t.time==e&&(t.indicator==n||t.indicator==r))return t}));return i}function H(t,e){var r=b[e],n=t.filter((function(t){if(t.indicator==r||t.indicator==e)return t}));return n}function Z(t,e){var r=t.map((function(t){var r=0;"pm"!=e&&"aqi"!=e||(r=(t.value*x[e]).toFixed(0)),"mcp"==e&&(r=(t.value*x[e]).toFixed(2));for(var n=1;n<v[e].length;n++)if(Number(r)>=v[e][n-1]&&Number(r)<v[e][n])return{id:t.site,project:t.project,fill:E[e][n-1].color,radius:27,value:r,text:E[e][n-1].text,font:"20px sans-serif",stroke:{color:"white",width:2},zindex:10,coordinates:t.coordinates}}));return r}function V(t,e){if(!t||!e)return[];var r=[];return e.forEach((function(e,n){r.push({project:e,features:[]}),t.forEach((function(t){t.properties.project==e&&r[n].features.push(t)}))})),r}function K(t){var e=35,r=t.map((function(t){var r=1e3*t.value,n=(r/e).toFixed(2);return{site:t.site,indicator:"371",project:t.project,time:t.time,hour:t.hour,value:n,coordinates:t.coordinates}}));return r}function Q(t,e,r){var n=e.map((function(e){var n=$(t,e,r),i=J(n,r);return{AVG:i}})),i=n.map((function(t){for(var e=0;e<v[r].length;e++)if(Number(t.AVG)>=v[r][e-1]&&Number(t.AVG)<v[r][e])return{color:E[r][e-1].color,text:E[r][e-1].text,value:t.AVG}}));return i}function J(t,e){var r=0,n=t.length;return t.forEach((function(t){r+=Number(t.value)})),"pm"==e||"aqi"==e||"temp"==e?(r/n*x[e]).toFixed(0):"mcp"==e?(r/n*x[e]).toFixed(2):void 0}function Y(t,e){for(var r=[],n=function(n){var i=t.filter((function(t){if(t.hour==A[n])return t})),a=J(i,e);r.push({hour:A[n],value:a,time:i[0].time})},i=0;i<A.length;i++)n(i);return r}function X(t){for(var e=[],r=0;r<t.length;r++)e.push.apply(e,Object(l["a"])(t[r].datasets));return e}function tt(t,e){var r=[],n=[],i=[];"dir"!=e?t.forEach((function(t){"00:00"==t.hour?r.push(q(t.time,!0)):r.push(t.hour);var a=Number(t.value);"mcp"==e?n.push(a.toFixed(2)):n.push(a.toFixed(1));for(var o=0;o<v[e].length;o++)Number(t.value)>=v[e][o-1]&&Number(t.value)<v[e][o]&&i.push(E[e][o-1].color)})):(r=w,n=t,t.forEach((function(t){for(var r=0;r<v[e].length;r++)Number(t)>=v[e][r-1]&&Number(t)<v[e][r]&&i.push(E[e][r-1].color)})));var a={labels:r,indicator:e,datasets:[{label:y[e],backgroundColor:i,borderWidth:1,data:n}]};return a}function et(t){return t>=0&&t<11.25?"С":t>=11.25&&t<33.75?"ССВ":t>=33.75&&t<56.25?"СВ":t>=56.25&&t<78.75?"ВСВ":t>=78.75&&t<101.25?"В":t>=101.25&&t<123.75?"ВЮВ":t>=123.75&&t<146.25?"ЮВ":t>=146.25&&t<168.75?"ЮЮВ":t>=168.75&&t<191.25?"Ю":t>=191.25&&t<213.75?"ЮЮЗ":t>=213.75&&t<236.25?"ЮЗ":t>=236.25&&t<258.75?"ЗЮЗ":t>=258.75&&t<281.25?"З":t>=281.25&&t<303.75?"ЗСЗ":t>=303.75&&t<326.25?"СЗ":t>=326.25&&t<348.75?"ССЗ":t>=348.75?"С":void 0}function rt(t){return t>=0&&t<11.25?0:t>=11.25&&t<33.75?22.5:t>=33.75&&t<56.25?45:t>=56.25&&t<78.75?67.5:t>=78.75&&t<101.25?90:t>=101.25&&t<123.75?112.5:t>=123.75&&t<146.25?135:t>=146.25&&t<168.75?157.5:t>=168.75&&t<191.25?180:t>=191.25&&t<213.75?202.5:t>=213.75&&t<236.25?225:t>=236.25&&t<258.75?247.5:t>=258.75&&t<281.25?270:t>=281.25&&t<303.75?292.5:t>=303.75&&t<326.25?315:t>=326.25&&t<348.75?337.5:t>=348.75?0:void 0}function nt(t){var e=[];t.forEach((function(t){e.push(t.text)}));var r=e.reduce((function(t,e){return t[e]=(t[e]||0)+1,t}),{}),n=[];return w.forEach((function(t){r[t]?n.push(r[t]):n.push(0)})),n}var it=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("svg",{attrs:{x:"0px",y:"0px",viewBox:"0 0 512 512",width:"15px",height:"15px",fill:t.color}},[r("g",[r("g",[r("path",{attrs:{d:"M255.996,106c-82.705,0-150,67.295-150,150s67.295,150,150,150s150-67.295,150-150S338.701,106,255.996,106z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M411.696,346c-15.6,27.299-38.699,50.099-66,66l90.3,24.3L411.696,346z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M255.996,0l-46.199,82.299C224.497,78.1,240.095,76,255.996,76s31.5,2.1,46.2,6.299L255.996,0z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M75.996,76l24.3,90c15.601-27.301,38.101-49.801,65.4-65.7L75.996,76z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M82.297,209.5l-82,46.5l82,46.5c-4.2-14.7-6.301-30.3-6.301-46.5C75.996,239.799,78.096,224.2,82.297,209.5z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M100.296,346l-24.3,90.3l90.3-24.3C138.996,396.099,115.897,373.299,100.296,346z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M255.996,436c-16.199,0-31.8-2.1-46.8-6.301l46.8,82.301l46.8-82.301C287.796,433.899,272.195,436,255.996,436z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M346.159,100.452c27.14,15.795,49.756,38.43,65.514,65.596l24.426-90.004L346.159,100.452z"}})])]),r("g",[r("g",[r("path",{attrs:{d:"M511.703,256.146l-81.951-46.39c3.941,14.786,6.244,30.233,6.244,46.244c0,16.135-2.333,31.703-6.334,46.593\n\t\t\tL511.703,256.146z"}})])]),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g")])},at=[],ot={props:["color"]},st=ot,ct=r("2877"),lt=Object(ct["a"])(st,it,at,!1,null,null,null),ut=lt.exports,dt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("svg",{attrs:{viewBox:"-12 0 448 448.04455",width:"15px",height:"15px",xmlns:"http://www.w3.org/2000/svg",fill:t.color}},[r("path",{attrs:{d:"m224.023438 448.03125c85.714843.902344 164.011718-48.488281 200.117187-126.230469-22.722656 9.914063-47.332031 14.769531-72.117187 14.230469-97.15625-.109375-175.890626-78.84375-176-176 .972656-65.71875 37.234374-125.832031 94.910156-157.351562-15.554688-1.980469-31.230469-2.867188-46.910156-2.648438-123.714844 0-224.0000005 100.289062-224.0000005 224 0 123.714844 100.2851565 224 224.0000005 224zm0 0"}})])},pt=[],ht={props:["color"]},mt=ht,ft=Object(ct["a"])(mt,dt,pt,!1,null,null,null),gt=ft.exports,vt={props:["dates","tooltips","wind","loading"],components:{Sun:ut,Moon:gt},data:function(){return{selectedIndex:0,selectedProject:[],indicator:"PM2.5",min:0,max:7,text:"Play",play:!1,t:[],activeElement:0,indicators:[{name:"PM2.5",type:"pm",description:{text:"Концентрация взвешенных частиц",unit:"мкг/м",sup:"3"}},{name:"AQI",type:"aqi",description:{text:"Индекс качества воздуха AQI",sup:"",units:""}},{name:"ПДКсс",type:"mcp",description:{text:"Доля среднесуточного ПДК",sup:"3",unit:"= 35 мкг/м"}}],projects:[{id:9,name:"КНЦ"},{id:1,name:"Министерство"},{id:8,name:"Nebo"},{id:12,name:"Эковизор"}]}},mounted:function(){var t=this,e=localStorage.getItem("air.indicator");e||(e="pm");var r=this.indicators.find((function(t){if(t.type==e)return t}));r?this.UpdateIndicator(r.type,r.description,r.name):this.UpdateIndicator(this.indicators[0].type,this.indicators[0].description,this.indicators[0].name);var n=localStorage.getItem("air.projects");if(n){var i=n.split(",");this.selectedProject=i}else this.selectedProject=[1,8,9,12];this.UpdateProject(),document.addEventListener("keydown",(function(e){t.Key(e)}))},methods:{Key:function(t){"ArrowLeft"!=t.code&&"ArrowDown"!=t.code||this.ArrowLeft(),"ArrowRight"!=t.code&&"ArrowUp"!=t.code||this.ArrowRight()},ArrowLeft:function(){this.activeElement>0&&(this.activeElement-=1,this.selectedIndex=this.dates[this.activeElement],this.UpdateTime())},ArrowRight:function(){this.activeElement<6&&(this.activeElement+=1,this.selectedIndex=this.dates[this.activeElement],this.UpdateTime())},ShowAnalytic:function(){this.$emit("show-analytic")},UpdateTime:function(){this.$emit("update-time",this.selectedIndex,this.play)},UpdateIndicator:function(t,e,r){localStorage.setItem("air.indicator",t),this.Pause(),this.indicator=r,this.$emit("update-indicator",t,e)},UpdateProject:function(){localStorage.setItem("air.projects",this.selectedProject),this.$emit("update-projects",this.selectedProject)},Play:function(){var t=this,e=2e3;this.text="Pause",this.UpdateTime(),this.activeElement=0;for(var r=function(r){t.t.push(setTimeout((function(){t.play&&(t.activeElement=r,t.selectedIndex=t.dates[r],t.UpdateTime()),r==t.max-1&&t.Pause()}),r*e))},n=this.activeElement;n<this.max;n++)r(n)},Pause:function(){this.play=!1,this.t.forEach((function(t){clearTimeout(t)})),this.text="Play"},Action:function(){this.play=!this.play,this.play?this.Play():this.Pause()},Formater:function(t){return q(t)},LightenDarkenColor:function(t,e,r,n){var i,a,o,s,l,u,d,p=parseInt,h=Math.round,m="string"==typeof r;return"number"!=typeof t||t<-1||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||r&&!m?null:(this.pSBCr||(this.pSBCr=function(t){var e=t.length,r={};if(e>9){var n,s;if(n=t=t.split(","),s=Object(c["a"])(n,4),i=s[0],a=s[1],o=s[2],m=s[3],e=t.length,e<3||e>4)return null;r.r=p("a"==i[3]?i.slice(5):i.slice(4)),r.g=p(a),r.b=p(o),r.a=m?parseFloat(m):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+t[4]:"")),t=p(t.slice(1),16),9==e||5==e?(r.r=t>>24&255,r.g=t>>16&255,r.b=t>>8&255,r.a=h((255&t)/.255)/1e3):(r.r=t>>16,r.g=t>>8&255,r.b=255&t,r.a=-1)}return r}),d=e.length>9,d=m?r.length>9||"c"==r&&!d:d,l=this.pSBCr(e),s=t<0,u=r&&"c"!=r?this.pSBCr(r):s?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},t=s?-1*t:t,s=1-t,l&&u?(n?(i=h(s*l.r+t*u.r),a=h(s*l.g+t*u.g),o=h(s*l.b+t*u.b)):(i=h(Math.pow(s*Math.pow(l.r,2)+t*Math.pow(u.r,2),.5)),a=h(Math.pow(s*Math.pow(l.g,2)+t*Math.pow(u.g,2),.5)),o=h(Math.pow(s*Math.pow(l.b,2)+t*Math.pow(u.b,2),.5))),m=l.a,u=u.a,l=m>=0||u>=0,m=l?m<0?u:u<0?m:m*s+u*t:0,d?"rgb"+(l?"a(":"(")+i+","+a+","+o+(l?","+h(1e3*m)/1e3:"")+")":"#"+(4294967296+16777216*i+65536*a+256*o+(l?h(255*m):0)).toString(16).slice(1,l?void 0:-2)):null)},Active:function(t){this.selectedIndex=this.dates[t],this.activeElement=t,this.Pause(),this.UpdateTime()}}},bt=vt,yt=(r("33cf"),Object(ct["a"])(bt,o,s,!1,null,null,null)),xt=yt.exports,wt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("vl-map",{ref:"map",attrs:{controls:!1},on:{pointermove:t.onMapPointerMove}},[r("vl-view",{attrs:{zoom:t.zoom,minZoom:t.minZoom,maxZoom:t.maxZoom,center:t.center,projection:t.projection}}),r("vl-layer-tile",{attrs:{id:"xkcd"}},[r("vl-source-wms",{attrs:{"layer-name":"layerName",url:t.url,attributions:t.attributions,layers:t.layer,format:t.format,version:t.version,projection:t.projection,resolutions:t.resolutions,tileGrid:t.tileGrid,extent:t.extent,zIndex:1}})],1),t._l(t.features,(function(e,n){return r("vl-layer-vector",{key:n},[r("vl-source-vector",{ref:"gjsource",refInFor:!0,attrs:{features:e.features,projection:t.projection,extent:t.extent}}),r("vl-style-func",{attrs:{factory:t.pointsStyleFunc}})],1)})),t.currentPosition?r("vl-overlay",{attrs:{position:t.currentPosition,projection:t.projection,extent:t.extent,"auto-pan":!0}},[[r("div",{staticClass:"overlay_videoclip"},[t._v(t._s(t.text))])]],2):t._e()],2)},_t=[],jt=(r("cb29"),r("ce2c")),kt=r("83a6"),Ct=r("8682"),Pt=r("35d8"),Et=r("6c77"),At=r("8295"),Dt=r("2986");d["a"].defs("EPSG:4326"),d["a"].defs("EPSG:28416","+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +ellps=krass +towgs84=23.92,-141.27,-80.9,-0,0.35,0.82,-0.12 +units=m +no_defs");var Mt={extent:[11385622.915,2840622.915,21404377.085,12859377.085],resolutions:[39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135],proj:"EPSG:28416",projText:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +ellps=krass +towgs84=23.92,-141.27,-80.9,-0,0.35,0.82,-0.12 +units=m +no_defs"},St=Dt["y"]({code:Mt.proj,extent:Mt.extent,units:"m"});Dt["r"](St);var Ft={props:["layers","sites","projects"],data:function(){return{show:!0,currentPosition:void 0,text:"",zoom:10.5,maxZoom:15,minZoom:9.5,center:Object(d["a"])("EPSG:4326","EPSG:28416",[92.886,56.038]),rotation:0,extent:Mt.extent,projection:St.getCode(),layer:"egis_gk_light",format:"image/png",version:"1.1.1",tileGrid:{extent:Mt.extent,resolutions:Mt.resolutions},resolutions:Mt.resolutions,crossOrigin:"anonymous",url:"http://map{1-4}.24bpd.ru/geowebcache/service/wms?",attributions:['© <a href="http://24bpd.ru/" target="_blank">Енисей-ГИС</a>']}},methods:{onMapPointerMove:function(t){var e=this.$refs.map,r=e.forEachFeatureAtPixel(t.pixel,(function(t){return t}));if(r){var n=r.getId(),i=this.sites.find((function(t){if(t.id==n)return t})),a=r.getGeometry().getCoordinates();this.currentPosition=a,this.text=i.name}else this.currentPosition=void 0},pointsStyleFunc:function(){return function(t){var e=t.get("project"),r=null;9==e&&(r=new jt["a"]({opacity:0,radius:t.get("radius"),fill:new kt["a"]({color:t.get("color")}),stroke:new Ct["a"](t.get("stroke"))})),1==e&&(r=new Pt["a"]({opacity:0,radius:t.get("radius"),fill:new kt["a"]({color:t.get("color")}),points:5,stroke:new Ct["a"](t.get("stroke"))})),12==e&&(r=new Pt["a"]({fill:new kt["a"]({color:t.get("color")}),stroke:new Ct["a"](t.get("stroke")),points:4,radius:t.get("radius")+5})),8==e&&(r=new Pt["a"]({fill:new kt["a"]({color:t.get("color")}),stroke:new Ct["a"](t.get("stroke")),points:4,radius:t.get("radius")+5,angle:Math.PI/4}));var n=new Et["a"]({image:r,text:new At["a"]({font:t.get("font"),text:t.get("value"),fill:new kt["a"]({color:t.get("fontColor")})})});return[n]}}},computed:{features:function(){var t=this.layers.map((function(t){return{type:"Feature",id:t.id,geometry:{type:"Point",coordinates:t.coordinates},properties:{project:t.project,radius:t.radius,font:t.font,value:t.value,fontColor:t.text,color:t.fill,stroke:t.stroke}}})),e=V(t,this.projects);return e}}},Nt=Ft,It=(r("5490"),Object(ct["a"])(Nt,wt,_t,!1,null,null,null)),Tt=It.exports,Ot={name:"App",data:function(){return{receivedData:[],receivedDataHour:[],receivedWind:[],receivedSites:[],selectedProjects:[1,8,9,12],selectedDataForChart:[],selectedDataForRose:[],selectedDataForChartWind:[],selectedDataForChartWindDir3hour:[],savedDataforChart:[],savedDataforChartWind:[],layers:[],tooltips:[],dates:[],indicator:"pm",description:{text:"Концентрация взвешенных частиц",unit:"мкг/м",sup:"3"},time:"",loading:!1,showAnalytic:!1}},components:{Map:Tt,Control:xt,Analytics:function(){return r.e("chunk-309e0c4e").then(r.bind(null,"f8b4e"))}},mounted:function(){var t=this;B().then((function(e){t.time=e[0],T(e,[1,8,9,12]).then((function(e){t.receivedSites=e})),S(e,[1,8,9,12],["pm","aqi","mcp"],"1day").then((function(r){var n=localStorage.getItem("air.indicator");n&&(t.indicator=n),t.dates=e,t.receivedData=r,t.tooltips=Q(r,e,t.indicator);var i=$(r,e[0],t.indicator);t.layers=Z(i,t.indicator)})),N(e,["temp"],"1day").then((function(e){var r=H(e,"temp").map((function(t){return{avg:Number(t.value).toFixed(0),min:Number(t.min).toFixed(0),max:Number(t.max).toFixed(0)}}));t.receivedWind={temp:r}})),N(e,["speed","dir"],"3hour").then((function(e){var r=H(e,"speed"),n=H(e,"dir").map((function(t){return{hour:t.hour,value:rt(t.value),text:et(t.value)}}));t.savedDataforChart.push({time:1,indicator:"speed",datasets:r}),t.savedDataforChart.push({time:1,indicator:"dir3hour",datasets:n})})),N(e,["dir"],"1hour").then((function(r){e.forEach((function(e){var n=$(r,e,"dir").map((function(t){return{time:t.time,hour:t.hour,value:rt(t.value),text:et(t.value)}})),i=nt(n);t.savedDataforChart.push({time:e,indicator:"dir",datasets:i}),t.UpdateAnalyticWind()}))})),S(e,[1,8,9,12],["pm","aqi"],"3hour").then((function(r){e.forEach((function(e){var n=$(r,e,"pm"),i=$(r,e,"aqi"),a=Y(n,"pm"),o=Y(i,"aqi"),s=K(n),c=Y(s,"mcp");t.savedDataforChart.push({time:e,indicator:"pm",datasets:a}),t.savedDataforChart.push({time:e,indicator:"aqi",datasets:o}),t.savedDataforChart.push({time:e,indicator:"mcp",datasets:c}),t.loading+=1})),t.UpdateAnalyticIndicators()}))}))},methods:{ShowAnalytic:function(){this.showAnalytic=!this.showAnalytic},UpdateAnalyticIndicators:function(){var t=H(this.savedDataforChart,this.indicator),e=X(t),r=tt(e,this.indicator);this.selectedDataForChart=r},UpdateAnalyticWind:function(){var t=H(this.savedDataforChart,"speed"),e=H(this.savedDataforChart,"dir"),r=H(this.savedDataforChart,"dir3hour"),n=X(t),i=tt(n,"speed"),a=e.map((function(t){return tt(t.datasets,"dir")}));this.selectedDataForChartWind=i,this.selectedDataForChartWindDir3hour=r,this.selectedDataForRose=a},UpdateMap:function(t){this.time=t;var e=$(this.receivedData,this.time,this.indicator);this.layers=Z(e,this.indicator)},UpdateProjets:function(t){this.selectedProjects=t},UpdateIndicator:function(t,e){this.indicator=t,this.description=e;var r=$(this.receivedData,this.time,this.indicator);this.layers=Z(r,t),this.tooltips=Q(this.receivedData,this.dates,t),this.UpdateAnalyticIndicators()}}},Ut=Ot,Lt=(r("034f"),Object(ct["a"])(Ut,i,a,!1,null,null,null)),Rt=Lt.exports,Gt=r("1cf8"),Bt=(r("4989"),r("f9e3"),r("2b69"),r("4971")),zt=r.n(Bt);r("24df");n["default"].component("VueSlider",zt.a),n["default"].config.productionTip=!1,n["default"].use(Gt["a"]),new n["default"]({render:function(t){return t(Rt)}}).$mount("#app")},5830:function(t,e,r){t.exports=r.p+"week/img/play.993f667f.svg"},"5ee4":function(t,e,r){},"85ec":function(t,e,r){},9618:function(t,e,r){t.exports=r.p+"week/img/bar-chart.f52c3fac.svg"},a6b6:function(t,e,r){},b889:function(t,e,r){t.exports=r.p+"week/img/rolling.0eb63514.svg"},ec7e:function(t,e,r){t.exports=r.p+"week/img/pause.c5b91dcd.svg"}});
//# sourceMappingURL=app.a3113d18.js.map